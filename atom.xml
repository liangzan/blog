<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Liang Zan - Blog]]></title>
  <link href="http://liangzan.github.com/blog/atom.xml" rel="self"/>
  <link href="http://liangzan.github.com/blog/"/>
  <updated>2018-03-12T09:16:04+00:00</updated>
  <id>http://liangzan.github.com/blog/</id>
  <author>
    <name><![CDATA[Wong Liang Zan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Business books on selling which I recommend]]></title>
    <link href="http://liangzan.github.com/blog/blog/2018/03/09/business-books-on-selling-which-i-recommend/"/>
    <updated>2018-03-09T17:10:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2018/03/09/business-books-on-selling-which-i-recommend</id>
    <content type="html"><![CDATA[<p>I&#8217;ve always been curious about selling, the complex kind, the kind with long sales cycle, <em>very</em> expensive(typically $100,000 or more) contracts, those needing multiple signatures. I&#8217;ve read a number of business books on the topic and these are the three that stand out.</p>

<!-- more -->


<h2>Strategic Selling</h2>

<p>What I like about <a href="https://www.amazon.com/New-Strategic-Selling-Successful-Companies-ebook/dp/B00HG5UPUM/ref=sr_1_1?ie=UTF8&amp;qid=1520587124&amp;sr=8-1&amp;keywords=strategic+selling">Strategic Selling</a> by Robert Miller, is he breaks down the complex sales process systematically, which appeals to me. He gives us a framework for thinking where the product&#8217;s positioning in the market. The different influencers within a customer&#8217;s company, and how to approach them. Now the sales process is broken into distinct steps where progress can be quantifiable. Though the quantifying step is still a judgement call. After reading the book, I realised that sales is a process that is repeatable.</p>

<h2>SPIN selling</h2>

<p><a href="https://www.amazon.com/SPIN-Selling-Neil-Rackham/dp/0070511136/ref=sr_1_1?ie=UTF8&amp;qid=1520587202&amp;sr=8-1&amp;keywords=spin+selling">SPIN selling</a> by Neil Rackham is published in the 1980s. Though that is a long time ago, I find that its wisdom is relevant today. After all, companies still sell to people today. Sales in the early days, thought that to sell more, sales people needs to be good at closing. Neil Rackham rejected that perception by collecting real world data and coming to the conclusion that the conventional closing methods don&#8217;t work. SPIN selling is a methodology of framing the questions to ask your customers such that the customer reveals important information and indirectly be convinced of the need to buy. Fantastic book, with a lot of rigour in its methods. Sadly I find such rigour sorely missing in business books.</p>

<h2>Challenger</h2>

<p><a href="https://www.amazon.com/Challenger-Sale-Control-Customer-Conversation-ebook/dp/B0052REP7K/ref=sr_1_2?ie=UTF8&amp;qid=1520587225&amp;sr=8-2&amp;keywords=challenger+sale">Challenger Sales Model</a> by Matthew Dixon and Brent Adamson is the predecessor of SPIN selling. It is heavily influenced by SPIN. It is not a replacement, depending on the sitation, you can use either SPIN or Challenger. Challenger Sales Model is great for businesses stuck in a commodity business, business selling products or services with little differentiation. It prompts you to think more strategically, becoming a partner of your customer and not only doing transactional sales where you are just a price number to them.</p>

<h2>Are they effective?</h2>

<p>Disclaimer, I&#8217;m not a veteran salesperson. However I&#8217;ve asked my friends who have been selling for 10-20 years. There is the viewpoint that Sales is a skill learned by doing, true in all careers. My friend don&#8217;t follow any framework strictly, but acts from experience. To him, there is no need to learn these frameworks. Another friend though, feels that they are useful. He introduced these frameworks into his sales team. But again, every situation is different and this is where experience comes in play.</p>

<p>These books cover different aspects of selling. Strategic Selling covers the selling process from a bird&#8217;s eye view. SPIN selling helps when you don&#8217;t know your customer. Challenger works for those who knows their customers well. Rather than pick one, my suggestion is you read all of them. It never hurts to learn more.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Things I would do at a new startup]]></title>
    <link href="http://liangzan.github.com/blog/blog/2018/01/12/things-i-would-do-at-a-new-startup/"/>
    <updated>2018-01-12T16:08:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2018/01/12/things-i-would-do-at-a-new-startup</id>
    <content type="html"><![CDATA[<p>With the benefit of spending years at the trenches, watching decisions and their eventual impact, subconsciously I&#8217;ve formed my opinion on what I would do if I were to start building a new product.</p>

<!-- more -->


<h2>Using the New And Shiny</h2>

<p>That is for me tells me that the decision maker belongs to one of the <a href="https://en.wikipedia.org/wiki/Cargo_cult_programming">cargo-cult</a>. I&#8217;ve been through this stage. Why not the New And Shiny? Since it is new, few would have used it. Fewer using it means the eco-system of libraries is not as mature, and you are less likely to find solutions to your problems on StackOverflow. It means the hiring pool is smaller, with people coming in to learn rather than being productive at the start. It means nobody knows where the New And Shiny&#8217;s warts are, so unfortunately you will be the one who will find those warts in <strong>production</strong>. woken up by a phone call at 3am on a Sunday morning, realising the server has crashed, and nobody knows why. Warts are found through the hard way, not discovered through simple programs written on blog posts. All these small things slows you down, a literal death by a thousand cuts to a fledgling company.</p>

<p>Your job as a decision maker is to deliver the product, working, on time and on budget. It is not the time to be dabbling on new technologies to add to your resume, especially when there is limited time. If you haven&#8217;t written production code using it for more than a year, you don&#8217;t know it. Use something proven, use something you know. Your customers don&#8217;t care what powers it, and your customers are the ones you should be caring about, not impressing other programmers at meetups. Most New and Shiny are another way of achieving the same thing. A new Javascript framework is just another take on how to manipulate HTML. Maybe it is faster, or more elegant, to your customers it is the same - HTML. I&#8217;m guilty of this, and I recognise it especially in younger programmers. Control yourself and do the right thing - pick the boring, stable and working technologies that you worked with before.</p>

<h2>Throwing away working legacy code</h2>

<p>I&#8217;ve been guilty of throwing away perfectly working code, on several occasions, using excuses that it is poorly written, performing badly, or any jargony reason to pull one over business people. It is one of those tempting decisions to make when you are given a brownfield project. It is more exciting to start in a New And Shiny technology than to work on the old problem.</p>

<p>For the programmer, there are many reasons to do that. First, you get a chance to learn a New And Shiny technology, add it to your resume, and to demonstrate you have the brains to pick up the New And Shiny technology which is so difficult to learn, which proves that you are one of the elite. Second, you don&#8217;t have to wade through the humongous code base, littered with undocumented special cases, and did I say no tests? The alternative is to keep the codebase, which means reading <em>a lot of</em> code. Reading code is boring, painful, and much harder than writing your own, preventing the conception of what could haven been an elegant architecture from you. Third, it is much more impressive to be the person who wrote X, rather than to be the person who maintained X.</p>

<p>There is every reason for the programmer to want to write new stuff. Not for the poor business guy. The customers are expecting this list of old bugs to be fixed and these long-asked-for features to be built next month. Sadly, those aren&#8217;t coming. The programmer is throwing away <em>working</em> code and writing new ones which does HALF of what the <em>working</em> code did. That won&#8217;t be ready anytime soon. Woe on the business guy who has to placate the impatient customer. It is times like this that the customer feels they are not loved, and there should be better solutions out there, which they promptly switches upon finding something better. Business guys, don&#8217;t fall for this, the programmers are fooling you.</p>

<p>Control yourself(myself included), do not throw away working code - do the right thing which is to refactor the code, add tests and documentation.</p>

<h2>Processes are like habits</h2>

<p>An idea that I picked up from the tech echo-chambers is that processes are evil. They belong to the big bureaucracies, who can&#8217;t innovate. Only when I witnessed how the lack of processes harmed a growing company, that I realised these blog posts are written by people who&#8217;d never scaled a company before. I have to remind myself to be careful of what I read. Processes are like habits, good habits that helps the company stay aligned. They exists because they work at scale. They help the company stay on track as they add more employees, and keep chaos sane as more customers come. Things like proper documentation, proper commit messages, a process to release, regular progress updates, helps the company to stay aligned. Again, when to introduce processes depends. I&#8217;d lean towards introducing them early to cultivate the habits early. But not too much that it feels strangling. People should not be afraid to question processes. We have a tendency to accept processes as sacred rules - they are not. They are decided in the earlier days when the company was facing problems A, but now it can be a different set of problems, and those processes don&#8217;t work in the same context. Obviously you have to change them. Use processes to help your team stay aligned, not to hinder.</p>

<h2>Embrace technical debt</h2>

<p>We are taught from young that debts in any form are to be abhorred. Debts are for irresponsible people, people who can&#8217;t manage their finances, like gamblers, spendthrifts. We associate technical debt in the same way, thinking we should avoid them like plague. Contrary to that thinking, at the early stages, it is alright to tolerate technical debt.</p>

<p>At the early stage of a company, the biggest problem is product-market fit. In other words, is the thing you&#8217;re building solving a real world problem? Iterations should be fast. You should not be agonising over how scalable the code is, or whether code coverage is at 100%. Those things don&#8217;t matter if nobody wants the thing you&#8217;re building. I&#8217;ve seen this time and again. The founders come up with an idea, fall in love with it, thinking they know best, they build it using the state of the art, so proud of what they&#8217;ve built, not realising nobody wants to pay when they start selling it. All that elegant design, all those tests, are a waste of time, in the early stage that is. Only when you have the confidence that customers want what you&#8217;re building, then it is time to invest time to do quality work.</p>

<h2>Remote working at the start</h2>

<p>I was a believer in remote working. Now I&#8217;m a half-believer. It doesn&#8217;t work at the early stages, when the team culture is still forming. You simply don&#8217;t form bonds remotely. It doesn&#8217;t work for inexperienced engineers where you need teach. It doesn&#8217;t work when the time zones are more than 2 hours apart. Any time difference slows decisions and hamper communication. It doesn&#8217;t work when you&#8217;re at the early stage of building the product, when the team needs to make decisions fast and communicate the common vision. Having remote team members at that stage slows things down. At what point can you consider remote working? When you feel that you&#8217;ve reached product-market fit. When you have processes that ensures quality work, and good communication. When everybody, especially the decision makers, believe in remote work.</p>

<p>These are my opinions. Experiences forms opinions. Nobody will experience the same set of problems - they are unique to you. Advice usually comes in the form of this is what I did when I had this problem, I made this mistake, and this is what I would do if I can do it again. What works in my context, may not work in your context. Always take advice with a pinch of healthy skepticism. But when you have encountered a similar context, and knowing that others have made this mistake, it&#8217;d be foolish to repeat it.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What is the probability of my child entering Nanyang Primary or Ai Tong]]></title>
    <link href="http://liangzan.github.com/blog/blog/2017/07/19/what-is-the-probability-of-my-child-entering-nanyang-primary-or-ai-tong/"/>
    <updated>2017-07-19T12:30:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2017/07/19/what-is-the-probability-of-my-child-entering-nanyang-primary-or-ai-tong</id>
    <content type="html"><![CDATA[<p>Like most parents in Singapore, we leave no chance to getting to the best schools for our children. My wife wants to move closer to Nanyang Primary to increase our chance of getting a place. I did not want to do that. Our chances are high enough that it doesn&#8217;t warrant such extremes. I realised I needed to prove my point.</p>

<!-- more -->


<h2>How does primary school registration work?</h2>

<p>For the uninitiated, primary school registration is broken up into phases - similar to a priority queue, where the earlier phases get the places first. Phase 1 is for siblings of current students. Phase 2A is for the alumni. Phase 2B is for parent volunteers, community leaders, anybody related to the school. Finally, Phase 2C is for the public. When there are more applicants than places, citizens are prioritised over foreigners, followed by those living near the school. <a href="https://www.moe.gov.sg/admissions/primary-one-registration/phases">Details</a> on the official website</p>

<p>I&#8217;m lucky. I have two options. As an alumni of Nanyang Primary, I qualify for Phase 2A. As I live near Ai Tong School, I have a chance in Phase 2C. Both schools are wife-approved. What is the probability of my child getting into either schools?</p>

<h2>Probability of getting into Nanyang Primary</h2>

<p>The probability is dependent on 2 things: number of applicants and the number of places. The number of places depends on the number of applicants from Phase 1. How many will apply for Phase 1 in 2018?</p>

<h3>Finding the number of places for Phase 2A</h3>

<p>If you didn&#8217;t know already, the <a href="http://www.tylervigen.com/spurious-correlations">number of people who drowned by falling into a pool correlates to the films Nicholas Cage appeared in</a>. We ought to treat correlation results with care. However, it makes sense that the birth rate <em>should</em> correlate to the number of applicants. I took the <a href="http://www.tablebuilder.singstat.gov.sg/publicfacing/createDataTable.action?refId=3733">birth data</a> from the published government statistics. The <a href="http://nyps.moe.edu.sg/admission/p1-enrolment-data">enrolment statistics</a> and <a href="http://nyps.moe.edu.sg/admission/balloting-statistics">balloting statistics</a> for Nanyang Primary are published as well.</p>

<table class="table-values">
  <thead>
    <tr>
      <th>Year</th>
      <th>Residents Births</th>
      <th>Phase 1 applicants</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2016</td><td>35,129</td><td>196</td></td>
    <tr><td>2015</td><td>36,925</td><td>205</td></td>
    <tr><td>2014</td><td>37,277</td><td>191</td></td>
    <tr><td>2013</td><td>37,074</td><td>195</td></td>
    <tr><td>2012</td><td>36,272</td><td>187</td></td>
    <tr><td>2011</td><td>35,528</td><td>199</td></td>
    <tr><td>2010</td><td>35,135</td><td>179</td></td>
    <tr><td>2009</td><td>35,474</td><td>176</td></td>
    <tr><td>2008</td><td>38,555</td><td>180</td></td>
    <tr><td>2007</td><td>39,281</td><td>180</td></td>
  </tbody>
</table>


<p>The above is a table of data tabulating the number of resident births and Phase 1 applicants to Nanyang Primary. The <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">correlation coefficient</a> between the applicants and births is below.</p>

<table class="table-values">
  <thead>
    <tr>
      <th>Correlation Coefficient</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
   <tr>
     <td>Phase 1 vs Births</td>
     <td>-0.053323383</td>
   </tr>
  </tbody>
</table>


<p>The number of applicants is negatively correlated to the birth rate. Which means when there are more births, there are less applicants. It doesn&#8217;t make sense. Let&#8217;s look at the scatter plot.</p>

<p><img src="https://s3.amazonaws.com/static.liangzan.net/blog/nyps_phase1_vs_births.png" title="Nanyang Primary Phase 1 applicants vs Births" ></p>

<p>Applicants in 2018 will come from births in 2012 which is <strong>38,641</strong>. To be conservative, I selected the three points on the top left, drew a line through them to interpolate the number of applicants for 2018. It is <strong>215</strong>. Since the number of places at Nanyang is <strong>390</strong>, that leaves</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>390 - 215 = 175</span></code></pre></td></tr></table></div></figure>


<p><strong>175</strong> places. There is a <a href="http://www.todayonline.com/singapore/moe-40-spaces-reserved-every-primary-school-phase-2b-2c-applicants">law introduced in 2014</a> that there must be at least 40 places kept for Phase 2B and 2C. In the worst case scenario, that leaves</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>175 - 40 = 135</span></code></pre></td></tr></table></div></figure>


<p><strong>135</strong> places for Phase 2A. We now know the number of places on offer. Let us find the number of applicants next.</p>

<h2>Finding the number of applicants for Phase 2A</h2>

<p>Likewise, I believe that the number of applicants for Phase 2A <em>should</em> correlate to the number of births.</p>

<table class="table-values">
  <thead>
    <tr>
      <th>Year</th>
      <th>Residents Births</th>
      <th>Phase 2A1 applicants</th>
      <th>Phase 2A2 applicants</th>
      <th>Aggregated Phase 2A applicants</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2016</td><td>35,129</td><td>105</td><td>19</td><td>124</td></tr>
    <tr><td>2015</td><td>36,925</td><td>70</td><td>42</td><td>112</td></tr>
    <tr><td>2014</td><td>37,277</td><td>67</td><td>61</td><td>128</td></tr>
    <tr><td>2013</td><td>37,074</td><td>67</td><td>63</td><td>130</td></tr>
    <tr><td>2012</td><td>36,272</td><td>54</td><td>75</td><td>129</td></tr>
    <tr><td>2011</td><td>35,528</td><td>43</td><td>75</td><td>118</td></tr>
    <tr><td>2010</td><td>35,135</td><td>41</td><td>84</td><td>125</td></tr>
    <tr><td>2009</td><td>35,474</td><td>38</td><td>67</td><td>105</td></tr>
    <tr><td>2008</td><td>38,555</td><td>39</td><td>57</td><td>96</td></tr>
    <tr><td>2007</td><td>39,281</td><td>21</td><td>60</td><td>81</td></tr>
  </tbody>
</table>


<p>Likewise, we tabulate the number of resident to Phase 2A applicants. The correlation coefficient between the applicants and births is below.</p>

<table class="table-values">
  <thead>
    <tr>
      <th>Correlation Coefficient</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
<tr><td>Phase 2A1 vs Births</td><td>-0.405010861</td></tr>
<tr><td>Phase 2A2 vs Births</td><td>-0.056426767</td></tr>
<tr><td>Aggregated Phase 2A vs Births</td><td>-0.650995037</td></tr>
  </tbody>
</table>


<p>Again we see negative correlation, which does not make sense. It is likely to be skewed by the data from 2007-2008. Let&#8217;s use the scatter plot instead.</p>

<p><img src="https://s3.amazonaws.com/static.liangzan.net/blog/nyps_phase2a_vs_births.png" title="Nanyang Primary Phase 2A applicants vs Births" ></p>

<p>Ignoring the 2 data points from 2007-2008(at bottom right), I draw a line through to interpolate the number of applicants for Phase 2A. I arrived at <strong>145</strong> applicants.</p>

<p>With this figure, we can calculate the probability of my child getting a place in Nanyang Primary in Phase 2A.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Probability = (Number of places) / (Number of applicants in Phase 2A)
</span><span class='line'> = 135 / 145
</span><span class='line'> = 0.931034483</span></code></pre></td></tr></table></div></figure>


<p>My daughter has a <strong>93.1%</strong> chance of getting into Nanyang Primary. That&#8217;s reassuring.</p>

<h2>Backup plan: Ai Tong</h2>

<p>In the <strong>6.9%</strong> chance that my daughter won&#8217;t get into Nanyang Primary, what is the probability of her entering Ai Tong? That is dependent on the number of applicants to the number of places. Since the ruling in 2014 ensures that there are at least 20 places for Phase 2C, let us assume the worst and use <strong>20</strong> for the number of places available.</p>

<h2>Finding the number of applicants for Phase 2C</h2>

<p>Consistent with what we did previously, the number of Phase 2C applicants <em>should</em> correlate to the number of births.</p>

<table class="table-values">
  <thead>
    <tr>
      <th>Year</th>
      <th>Resident Births</th>
      <th>Phase 2C applicants</th>
      <th>Places</th>
      <th>TUR</th>
      <th>APP</th>
      <th>Probability</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>2016</td><td>35,129</td><td>49.83</td><td>33</td><td>0.9</td><td>1.51</td><td>0.662251656</td></tr>
    <tr><td>2015</td><td>36,925</td><td>46.2</td><td>23.1</td><td>0.93</td><td>2</td><td>0.5</td></tr>
    <tr><td>2014</td><td>37,277</td><td>44.55</td><td>29.7</td><td>0.91</td><td>1.5</td><td>0.666666667</td></tr>
    <tr><td>2013</td><td>37,074</td><td>35.838</td><td>6.6</td><td>0.98</td><td>5.43</td><td>0.184162063</td></tr>
    <tr><td>2012</td><td>36,272</td><td>58.212</td><td>23.1</td><td>0.93</td><td>2.52</td><td>0.396825397</td></tr>
    <tr><td>2011</td><td>35,528</td><td>67.32</td><td>19.8</td><td>0.94</td><td>3.4</td><td>0.294117647</td></tr>
    <tr><td>2010</td><td>35,135</td><td>67.32</td><td>39.6</td><td>0.88</td><td>1.7</td><td>0.588235294</td></tr>
    <tr><td>2009</td><td>35,474</td><td>65.835</td><td>49.5</td><td>0.85</td><td>1.33</td><td>0.751879699</td></tr>
    <tr><td>2008</td><td>38,555</td><td>64.548</td><td>39.6</td><td>0.88</td><td>1.63</td><td>0.613496933</td></tr>
    <tr><td>2007</td><td>39,281</td><td>66.33</td><td>49.5</td><td>0.85</td><td>1.34</td><td>0.746268657</td></tr>
    <tr><td>2006</td><td>36,272</td><td>79.596</td><td>29.7</td><td>0.91</td><td>2.68</td><td>0.373134328</td></tr>
  </tbody>
</table>


<p>There is data published on <a href="https://www.kiasuparents.com/kiasu/article/bishan/">Kiasu Parents</a>. The figures are in percentages. I had to infer the places from the percentages. <strong>TUR</strong> stands for cumulative take up rate, which is the percentage of the places that were taken by Phase 2C. <strong>APP</strong> is the ratio of applicants to the places available. As we are assuming the worst, we are not using that to estimate the number of places.</p>

<table class="table-values">
  <thead
    <tr><th>Correlation coefficient</th><th>Value</th></tr>
  </thead>
  <tbody>
    <tr><td>Phase 2C vs Births</td><td>-0.090778097</td></tr>
    <tr><td>Phase 2C vs Places</td><td>0.554622244</td></tr>
  </tbody>
</table>


<p>If we correlate births to the number of applicants, it returns a negative value which does not make sense. If we correlate number of applicants to the places available, it returns a positive correlation of around <strong>0.55</strong>. Parents could be making their decision to apply based on the number of places available.</p>

<p><img src="https://s3.amazonaws.com/static.liangzan.net/blog/aitong_places_vs_phas2c.png" title="Ai Tong Phase 2C applicants vs Places" ></p>

<p>Using the scatter plot, I drew a line to interpolate the number of applicants given <strong>20</strong> places. It is <strong>42</strong>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Probability = (Number of places) / (Number of applicants in Phase 2C)
</span><span class='line'> = 20 / 42
</span><span class='line'> = 0.476190476</span></code></pre></td></tr></table></div></figure>


<p>We conclude that my daughter has a <strong>47.6%</strong> chance of getting into Ai Tong at Phase 2C.</p>

<h2>Bringing everything together</h2>

<p>I have both the probabilities for getting a place in Nanyang Primary and Ai Tong. What I want to know is the probability of getting into either.</p>

<p>Let us first define our terms.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>A is the probability that we get a place in Nanyang
</span><span class='line'>B is the probability that we get a place in Ai Tong
</span><span class='line'>C is the probability that we get a place in Ai Tong, given we failed to get a place in Nanyang
</span><span class='line'>D is the probability that we failed to get a place in Nanyang</span></code></pre></td></tr></table></div></figure>


<p>To help the reader, I&#8217;ve copied out some probability equations.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(A|B) = P(A n B) / P(B) # conditional probability
</span><span class='line'>P(A n B) = P(A) * P(B|A) # when both A and B occurs
</span><span class='line'>P(A n B) = P(A) * P(B)   # for independent events
</span><span class='line'>P(A n B) = 0             # for mutually exclusive events
</span><span class='line'>P(A u B) = P(A) + P(B) - P(A n B)</span></code></pre></td></tr></table></div></figure>


<p>We want the result of the probabilities of A and C together. Since A anc C are mutually exclusive, <code>P(A n C)</code> is 0. The final result would be the addition of both probabilities.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(A u C) = P(A) + P(C) - P(A n C)
</span><span class='line'>         = P(A) + P(C) - 0
</span><span class='line'>         = P(A) + P(C)</span></code></pre></td></tr></table></div></figure>


<p>We already know <code>P(A) = 0.931</code>. So we need to find <code>P(C)</code>. Let us define <code>P(C)</code> as a conditional probability, since we want the probability of getting into Ai Tong, given that we failed to get a place in Nanyang.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(C) = P(B|D)
</span><span class='line'>     = P(B n D) / P(D)</span></code></pre></td></tr></table></div></figure>


<p>Does getting a place in Nanyang affect the probability of getting a place in Ai Tong? The number of places don&#8217;t change as it is set by law. The number of applicants will still be the same as people applying do not care about my result. They are mutually exclusive. Therefore,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(B n D) = 0</span></code></pre></td></tr></table></div></figure>


<p>Which means</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(C) = P(B|D)
</span><span class='line'>     = P(B n D) / P(D)
</span><span class='line'>     = 0</span></code></pre></td></tr></table></div></figure>


<p>That is obviously wrong. Did we do something wrong? Let&#8217;s redefine C as the probability that we get a place in Ai Tong, and we failed to get a place in Nanyang.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(C) = P(B n D)
</span><span class='line'>     = P(B) * P(D)</span></code></pre></td></tr></table></div></figure>


<p>We plug the result back to our first equation.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P(A u C) = P(A) + P(C)
</span><span class='line'>         = P(A) + (P(B) * P(D))
</span><span class='line'>         = 0.931 + (0.476 * 0.069)
</span><span class='line'>         = 0.963844</span></code></pre></td></tr></table></div></figure>


<p>It means that my daughter has an increased chance of <strong>96.3%</strong> of getting into Nanyang or Ai Tong. That&#8217;s reassuring.</p>

<p>With that figure, I can tell my wife not to worry. With this simple episode, you can see the usefulness of Math in helping to make decisions. Intuition can be <a href="https://en.wikipedia.org/wiki/Birthday_problem">misleading</a>. We must demand rigour in thinking when making decisions that has big impact.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why am I doing a Math degree]]></title>
    <link href="http://liangzan.github.com/blog/blog/2017/07/03/why-am-i-doing-a-math-degree/"/>
    <updated>2017-07-03T05:48:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2017/07/03/why-am-i-doing-a-math-degree</id>
    <content type="html"><![CDATA[<p>I am applying to do a Math degree in my mid-thirties, knowing how much work that is, mindful of my work and family commitments, and not forgetting the cost. I&#8217;ve got an <a href="https://www.ece.nus.edu.sg/home/education/ee.html">Electrical Engineering</a> degree. It&#8217;s common to do a graduate degree, though a more conventional route would be to do a MBA or a Masters in Computer Science/Data science. Yet I chosen a Bachelor&#8217;s in Math.</p>

<!-- more -->


<h2>Why Math?</h2>

<p>The longer you spend in the technology industry, the more you realise that everything boils down to Math. It may not appear so on the surface. In day to day work, a working developer rarely touches Math. You don&#8217;t need Math if you&#8217;re building <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> apps, calling <a href="https://en.wikipedia.org/wiki/Application_programming_interface">APIs</a> or munging the data and presenting them. But as you reach scale, that is when you encounter problems that needs Math.</p>

<p>Take for example, you&#8217;re building <a href="https://www.ubereats.com">Uber Eats</a>. Your promise to the customer is to deliver what she ordered within an hour. Easy. We match the order to the driver who is nearest to the restaurant. That&#8217;s fine for 1 order, what happens when there&#8217;re 10 orders to the same restaurant with only 2 drivers? Let&#8217;s split the orders by the number of drivers which is 5 each, then deliver them in order by proximity. Problem solved. What happens when there&#8217;re 100 orders with a pool of 5 drivers to the same restaurant? Worse, the same restaurant has 3 branches, each capable of serving the orders. How are you going to match order to driver such that you can satisfy them within an hour? That is <a href="https://en.wikipedia.org/wiki/Vehicle_routing_problem">route optimisation</a> which boils down to combinatorial optimisation - Math.</p>

<p>At a certain point, I wasn&#8217;t satisfied with coming out with algorithms that <em>feels intuitively logical</em>. How do you know that this is correct? Some would say tests. For the Uber Eats example, we can decide on an algorithm that divides the orders equally amongst the drivers by proximity. It <em>feels</em> logical, but is it truly correct? Testing can verify that the implementation works. But tests won&#8217;t show you how to craft the algorithm correctly. Math does.</p>

<p>Math is at the heart of many fields. <a href="https://en.wikipedia.org/wiki/Data_science">Data science</a> is <a href="https://en.wikipedia.org/wiki/Statistics">statistics</a>, <a href="https://en.wikipedia.org/wiki/Linear_algebra">linear algebra</a>, <a href="https://en.wikipedia.org/wiki/Probability">probability</a> and <a href="https://en.wikipedia.org/wiki/Calculus">calculus</a>. <a href="https://en.wikipedia.org/wiki/Cryptocurrency">Cryto-currencies</a> is <a href="https://en.wikipedia.org/wiki/Number_theory">number theory</a>, probability and <a href="https://en.wikipedia.org/wiki/Finite_field">finite fields</a>. Facebook, Google and LinkedIn are built on <a href="https://en.wikipedia.org/wiki/Graph_theory">graph theory</a>. Not just in technology, Math touches many industries. Those figures in the insurance you bought were calculated by an <a href="https://en.wikipedia.org/wiki/Actuary">Actuary</a> who is using Probability. <a href="https://en.wikipedia.org/wiki/Economist">Economists</a> uses Statistics to help formulate policies. Physicists use Math to model phenomenon and to make predictions. There&#8217;s a ceiling to the scale of problems you can solve without using Math. We should demand rigour when formulating solutions and not be contented with what may appear to work on the surface.</p>

<h2>Learning for working adults is broken</h2>

<p>Education as a product is broken for working adults. For a part time Masters at a local university, you need to spend 3 evenings(1900-2230) and one full day on Saturday(0900-1700). That&#8217;s not accounting for time spent on studying, travelling and assignments. How much time does that leave for my family? That would be the end of my social life for those years. I inquired about doing less credits by stretching out the course.</p>

<blockquote><p>Sorry, you cannot do that.</p></blockquote>


<p>Paying a five figure sum for a course where I have to fit my schedule around yours is something I don&#8217;t comprehend. I suspect it was to fit in with their full-time programmes, to streamline costs. Implicitly it shows that part time students are less important. Sorry, but this product is not for me.</p>

<p>The thought of getting another degree was put away. Until one day, my colleague <a href="http://www.machinesung.com/">Kenny</a> mentioned he was going to do a degree. He was working full time and have a family. He managed to find a distance course that allows him time with his family, not so expensive that he has to downgrade his lifestyle, accredited, and offers Math. Initially I thought it was one of <a href="https://www.udacity.com">Udacity</a> or <a href="https://www.coursera.org/">Coursera</a>. It wasn&#8217;t. It was a proper university in the UK, one that only does distance learning - <a href="http://www.openuniversity.edu/">Open University</a>. That piqued my interest.</p>

<p>There&#8217;re lots of options for further education. Why not Udacity or Coursera? I wanted something structured, not a series of unrelated short courses. <a href="https://en.wikipedia.org/wiki/Massive_open_online_course">MOOCs</a> are out. How about a MBA? No, I don&#8217;t believe you can learn how to run a business in a school. Reading about them in case studies is not real. That is unless you want to build your network. Again, networking is not exclusive to MBA programmes. MBAs are out. What about a Masters in Computer Science? There is a good <a href="http://www.cc.gatech.edu/academics/degree-programs/masters/computer-science/admissionreqs">Masters programme</a> in Georgia Institute of Technology which can be completed via distance learning. I took a look at the courses. A third of them won&#8217;t be useful as I won&#8217;t be working in those fields, a third of them are things I already know, the last third is what&#8217;s worth learning. Computer science is out. How about Finance? I saw how useful accounting knowledge was to understanding the health of a business, and how it helps in making decisions. Between Math and Finance, Math felt the more useful and the more applicable. Math is also timeless. With a background in Math, topics in Finance should not be a problem.</p>

<p>There are other courses that offers Math, but none that focuses exclusively on distance learning students like the Open University. Material and classes are online and can be taken at your own pace. The course can be extended for up to 16 years. The course fees are half of what it costs for the similar in the US. Plus it is accredited in UK and Europe. The <a href="http://www.openuniversity.edu/courses/find/mathematics-and-statistics">modules</a> look applicable and interesting. The Open University is distance learning done right.</p>

<p>I&#8217;m going to enjoy the process of learning. This blog post shares the mental process that I went through when researching for further education. Hopefully it helps you. Everybody has 24 hours a day. It is how you make use of time that decides where you&#8217;re going.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using more than a hundred stored procedures in production]]></title>
    <link href="http://liangzan.github.com/blog/blog/2017/04/23/using-more-than-a-hundred-stored-procedures-in-production/"/>
    <updated>2017-04-23T06:50:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2017/04/23/using-more-than-a-hundred-stored-procedures-in-production</id>
    <content type="html"><![CDATA[<p>At my present company <a href="https://www.storeviva.com/">Courex</a>, we make heavy use of stored procedures, triggers and functions to run our production applications for over 2 years. At present, we have 258 stored procedures, 107 functions and triggers. Few companies use this many stored procedures. Would we recommend it? Yes.</p>

<!-- more -->


<p>Life started as a conventional PHP-MySQL web application built by an outsourced team. Obviously with outsourced teams hired on a shoestring budget, it was plagued with performance issues and bugs.</p>

<h2>Good: Abstraction</h2>

<p>The PHP code was taking input from a form, constructing SQL queries, running them, finally rendering the results. There were a series of different queries to run. This pattern repeated in most parts of the application. Thus the idea of using stored procedures was mooted. What stored procedures did was it abstracted over the series of queries as one procedure call, simplifying the code.</p>

<p>In the past the code did this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="k">FROM</span> <span class="n">foo</span><span class="p">;</span>
</span><span class='line'><span class="k">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="k">c</span> <span class="k">FROM</span> <span class="n">bar</span><span class="p">;</span>
</span><span class='line'><span class="k">UPDATE</span> <span class="n">foo</span> <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="k">WHERE</span> <span class="n">baz</span> <span class="o">=</span> <span class="n">boo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we do this</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">CALL</span> <span class="n">update_foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>They are no different from functions. All the usual engineering best practices apply. For example, we are able to name the stored procedure. Now we can use a meaningful name called <code>create_delivery</code> and it does what we expect - insert a delivery row. Instead of updating the same query repeated across 10 files, we update the one stored procedure. That&#8217;s a maintenance win.</p>

<h2>Good: Code reuse</h2>

<p>We have code bases in different programming languages, but 1 database. All code bases have access to those same functions and procedures on the database. We have procedures that converts types, procedures that does validations, triggers that updates time stamps. All that comes free as long as you can make a MySQL query.</p>

<p>In fact, we implemented our message queue purely in stored procedures. All our applications were able to <em>just</em> use it without much fanfare since it is just a sql query.</p>

<h2>Good: Well understood</h2>

<p>SQL along with Javascript are basic skills that we came to expect from every developer. From our experience, introducing them to our team and learning to use them is a non-issue. Jumping in to maintain them is also trivial. That&#8217;s a win.</p>

<h2>Good: No extra dependencies, stability and performance</h2>

<p>The best thing is there are no extra dependencies. I&#8217;ve came to appreciate projects with less moving parts. The less dependencies there are, the easier it is to setup and maintain.</p>

<p>MySQL also does not introduce major versions with breaking changes every few years. Using a mature relational database, we enjoy a level of stability and performance we don&#8217;t usually experience from other software. We enjoy the peace of mind it brings.</p>

<p>Of course there is a flip side.</p>

<h2>Bad: SQL has its warts</h2>

<p>SQL is not a good language for writing complex logic. Its warts slows down development time. Take error messages for example.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SQL</span> <span class="n">Error</span> <span class="p">(</span><span class="mi">1064</span><span class="p">):</span> <span class="n">You</span> <span class="n">have</span> <span class="n">an</span> <span class="n">error</span> <span class="k">in</span> <span class="n">your</span> <span class="k">SQL</span> <span class="n">syntax</span><span class="p">;</span> <span class="k">check</span> <span class="n">the</span> <span class="n">manual</span> <span class="n">that</span> <span class="n">corresponds</span> <span class="k">to</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">server</span> <span class="k">version</span> <span class="k">for</span> <span class="n">the</span> <span class="k">right</span> <span class="n">syntax</span> <span class="k">to</span> <span class="n">use</span> <span class="n">near</span> <span class="s1">&#39;foo&#39;</span> <span class="k">at</span> <span class="n">line</span> <span class="mi">1</span> <span class="o">*/</span>
</span></code></pre></td></tr></table></div></figure>


<p>We frequently encounter error messages that does not help. Non-helpful error messages slow down development.</p>

<p>Which brings me to our next point - readability. SQL is hardly readable when queries gets long. Being free-format led to a Cambrian explosion of indentation styles in the wild. I do not relish debugging a three hundred line query with non-helpful error messages.</p>

<p>I firmly belong to the camp where the more restrictive the language is, the easier it is to write correct code. SQL, without the strict mode, is too forgiving.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="ss">&quot;1&quot;</span> <span class="o">+</span> <span class="ss">&quot;1&quot;</span> <span class="o">//</span> <span class="k">returns</span> <span class="mi">2</span>
</span><span class='line'><span class="k">SELECT</span> <span class="mi">1</span> <span class="o">+</span> <span class="ss">&quot;1&quot;</span>   <span class="o">//</span> <span class="k">returns</span> <span class="mi">2</span>
</span><span class='line'><span class="k">SELECT</span> <span class="ss">&quot;a&quot;</span> <span class="o">+</span> <span class="ss">&quot;a&quot;</span> <span class="o">//</span> <span class="k">returns</span> <span class="mi">0</span>
</span><span class='line'><span class="k">SELECT</span> <span class="mi">1</span> <span class="o">+</span> <span class="k">NULL</span>  <span class="o">//</span> <span class="k">returns</span> <span class="n">NUL</span>
</span></code></pre></td></tr></table></div></figure>


<p>Even when expressions does not make sense, it returns something. It should not be type casting automatically, worse, not even showing a warning, giving a false sense of security. This can lead to dangerous bugs. Imagine the query is trying to add a sum of money to a bank account, and somehow one of the parameter is <code>NULL</code> or an alphabet, nothing will get added. As SQL deals directly with data, the impact of mistakes gets magnified.</p>

<h2>Bad: It needs powerful hardware</h2>

<p>As we use hundreds of stored procedures and functions, it is highly demanding on resources. Our database server has to be powerful. We&#8217;re forced to use dedicated hardware. In fact we tried using AWS RDS&#8217;s <code>db.m4.4xlarge</code> which is a 16-core 64GB RAM virtual machine with the max IOPS allocated. It didn&#8217;t work. We encountered table locks every few hours. We&#8217;ve tried various ways to tune it, but the locks did not go away. Mysteriously, once we were on dedicated hardware, it went away. Granted there could be ways to solve it on RDS(we aren&#8217;t professional DBAs), but it showed us that we need to invest on powerful servers for this approach to work.</p>

<p>There is obviously the problem of vendor lock in. SQL is not portable between the different databases. But isn&#8217;t that the same for your <code>&lt;insert your language&gt;</code> code base? To me this is a non-issue. I&#8217;ve also heard cases against stored procedures because of deployment or versioning. I&#8217;m not even sure they are problems to begin with. Treat stored procedures like normal code. Use a version control system. There is a tool <a href="https://flywaydb.org/">Flyway</a> which helps. Things you expect in modern deployment such as versioning, rolling back are all taken care of by Flyway.</p>

<p>Why wasn&#8217;t stored procedures more popular? I suspect it is because it is not <em>new</em> and not <em>marketed</em> much if at all. Most times, it is a short chapter on a SQL book. There are always shiny new things to adopt. Stored procedures does not have the <em>cool</em> factor. But it is <a href="http://mcfunley.com/choose-boring-technology">stable, boring and it works</a>. I got to thank my colleague <a href="https://github.com/prenaux">Pierre</a> who instigated this move. Hopefully more people would come to appreciate this feature of relational databases that almost no one talks about.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Communication skills > Technical skills]]></title>
    <link href="http://liangzan.github.com/blog/blog/2017/02/19/communication-skills-%3E-technical-skills/"/>
    <updated>2017-02-19T11:38:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2017/02/19/communication-skills->-technical-skills</id>
    <content type="html"><![CDATA[<p>Speaking or writing, is something I thought was basic, something anyone with a basic education can do. I felt that I was done with honing my language skills after I&#8217;ve left school. If the school thinks it was good enough to graduate, it was good enough.</p>

<!-- more -->


<p>Early in my career, I was more interested in building my technical skills. Companies would ask if you knew X language, mastered the Y framework or wrote apps that did Z. Those skills were measurable. Either you wrote something with it or you didn&#8217;t. It is much harder to measure communication skills.</p>

<p>Communication is the act of transferring information to another person. There are large variance in effectiveness. Imagine you have this fantastic idea of <strong>Uber for Sailing boats</strong> in absolute clarity in your head. You want to pitch this idea to a group of tourists, hoping they would try sailing. Communication is like drawing a mental picture of what you see in another person&#8217;s head. A skillful communicator would paint something like this in anothers mind:</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Rembrandt_Christ_in_the_Storm_on_the_Lake_of_Galilee.jpg/482px-Rembrandt_Christ_in_the_Storm_on_the_Lake_of_Galilee.jpg" title="Rembrandt's Church in the store on the lake of Galilee" ></p>

<p>While an average one may only let the tourists think of this:</p>

<p><img class="right" src="https://s3.amazonaws.com/static.liangzan.net/blog/6407942619_fe539a1580_m.jpg"></p>

<p>Your writing bridges the gap to your thoughts. The better you are, the more details they see, the easier they can understand you.</p>

<p>The technical world is awash with difficult concepts that needs better explanations. Take for example the <code>RAM</code>, how do you explain that to a five year old? I had difficulty understanding it when I was in my teens. My teachers calls it the <code>memory</code>. The word <code>memory</code> had connotations with storing information, which I naturally associated with our own memory. So what was the difference between the hard disks and the memory? Both store information correct? Why have two in a computer? This lingering question was never cleared up until after I wrote my first programs years later. The ability to pare down a foreign concept to something digestible is invaluable.</p>

<h2>Brevity in code and in documentation</h2>

<p>There are bad technical writing everywhere. The biggest problem is they are often too brief. Preference for brevity in code has diffused into documentation. Let&#8217;s take a look at how the official Scala docs attempts to explain <a href="http://docs.scala-lang.org/tutorials/tour/currying.html">currying</a>:</p>

<blockquote><p>Methods may define multiple parameter lists. When a method is called with a fewer number of parameter lists, then this will yield a function taking the missing parameter lists as its arguments.</p></blockquote>


<p>The definition is correct. The example demonstrates its usage. But do you <em>understand</em> when to use currying? Code should be brief as you are writing for the computer. But documentation are written for humans. Authors should strive to explain not only the how, but also why and when to use it. More horrors to come.</p>

<h2>Jargon-filled wishy washy</h2>

<p>From <a href="https://www.thoughtworks.com/radar">thoughtworks radar</a>:</p>

<blockquote><p>The microservices style of architecture highlights rising abstractions in the developer world because of containerization and the emphasis on low coupling, offering a high level of operational isolation. Developers can think of a container as a self-contained process and the PaaS as the common deployment target, using the microservices architecture as the common style. Decoupling the architecture allows the same for teams, cutting down on coordination cost among silos. Its attractiveness to both developers and DevOps has made this the de facto standard for new development in organizations.</p></blockquote>


<p>Do you know what the author is trying to say? Let me attempt to simplify it.</p>

<blockquote><p>Containers and Microservice complements each other naturally, yielding advantages. Low-coupling helps your infrastructure become more resilient. In the event of failure, the failure is isolated and does not bring down the entire infratructure. Being isolated allows teams to work independently, cutting down wasted time coordinating deployments. Its advantages has made it the standard for new projects in companies.</p></blockquote>


<p>Start with the topic sentence and cut down on the jargon. Your readers will thank you for it. I learned that from <em>Style</em>. Similar to <a href="https://www.amazon.com/Dont-Make-Me-Think-Usability/dp/0321344758">good user interfaces</a>, clear writing don&#8217;t make the user think.</p>

<h2>The mythical self-documenting code</h2>

<p>Every developer I met likes to write APIs but hates to write documentation. They will spend herculean effort, meticulously designing an intuitive RESTFUL API that scales, but they will put in the least amount of effort necessary to write documentation for it. Even resorting to <a href="http://swagger.io/">auto-generating documentation</a>. They would claim their API is so well designed, the endpoints and parameters so well named, that it is self-documented.</p>

<p>Have you heard of Haskell?</p>

<p>I was looking for a XML library. I found one and wanted to learn how to use it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">fromContent</span> <span class="ow">::</span> <span class="kt">Content</span> <span class="ow">-&gt;</span> <span class="kt">Cursor</span> <span class="kt">Source</span>
</span><span class='line'>
</span><span class='line'><span class="kt">A</span> <span class="n">cursor</span> <span class="n">for</span> <span class="n">the</span> <span class="n">given</span> <span class="n">content</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Sometimes I&#8217;m lucky - there is one sentence.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">fromTag</span> <span class="ow">::</span> <span class="kt">Tag</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Content</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">Element</span> <span class="kt">Source</span>
</span></code></pre></td></tr></table></div></figure>


<p>Most times I get a type signature.</p>

<p>Haskellers would often argue that the signature is good enough. Do you believe that, or do you think it is just excuses made to hide their disdain for writing documentation? Granted, this malady is widespread across all communities, but Haskell is in a plague that is.</p>

<p>Inevitably when emails start appearing asking what does that endpoint do, what does that parameter mean, you will realise that the time spent answering those emails could be better spent writing documentation in the first place. Perhaps it is because that employers look first for technical skills, and second on how well you communicate, that communication became a second citizen.</p>

<h2>Becoming the 10x multiplier</h2>

<p>If you are good at communication, you naturally become a 10x multiplier of others. It is more valuable than being <a href="http://antirez.com/news/112">the mythical 10x engineer</a>. It is a skill that should be valued, which sadly I don&#8217;t see. Things like onboarding new engineers to a new codebase, technical support overheads, all these go away with someone in your team who is a good teacher and patient enough to write. It is not hard to understand why as communication skill is impossible to quantify. Engineers when given a choice to work on their side projects or writing, would gravitate towards coding. It is what brings them to this profession. That is why we must insist that good engineers must not only build well, they must also communicate well.</p>

<p>How do you be better? Like every skill, you practice. Writing and speaking are but conduits to your thoughts. <a href="https://www.goodreads.com/">Read</a> voraciously, read widely, and think for yourself if what they say is correct. For writing, I recommend <a href="https://www.amazon.com/Style-Basics-Clarity-Grace-5th/dp/0321953304">Style: The Basics of Clarity and Grace </a> by Joseph Williams. This book distils the process of writing well into easy to understand steps. Compared to <a href="https://www.amazon.com/Writing-Well-Classic-Guide-Nonfiction/dp/0060891548">On Writing Well</a>, <em>Style</em> is better. The easy way is to dish out rule-of-thumbs, but he did not. There is a widely held misconception that passive voice is bad. In the right context, the sentence flows better with the passive voice. <em>Style</em> shows you that. You should read both books nonetheless.</p>

<p>I usually write on Emacs, and there are tools which I use and would recommend. I use <a href="https://www.gnu.org/software/ispell/ispell.html">ispell</a> to check my spelling. I use the <a href="https://github.com/bnbeckwith/writegood-mode">writegood mode</a> to catch passive voices and weasel words. There are readability tests like <a href="https://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests">Flesch-Kincaid</a> included in writegood mode which scores your writing. I also use <a href="http://www.thesaurus.com/">thesaurus.com</a> to find the exact words for conveying my thoughts.</p>

<p>To hone your speaking skills, practice. Find a <a href="https://www.toastmasters.org/">Toastmasters</a> chapter nearby, attend it and seek chances to speak. Toastmasters have impromptu sessions where you are given a topic to speak on the spot. Those are great exercises for thinking on your feet. In less than 10 sessions, you will lose the fear of public speaking. What is most valuable is you get feedback from others after every session.</p>

<p>There is this verse from <a href="https://en.wikipedia.org/wiki/Tao_Te_Ching">Tao Te Ching</a>:</p>

<blockquote><p>知不知，尚矣；不知知，病也</p></blockquote>


<p>Which means there are knowledge you know you don&#8217;t know(like I know I don&#8217;t know nuclear physics), and knowledge you don&#8217;t know you don&#8217;t know(like that missing breakthrough for robotics, if it exists). We should strive to know what we don&#8217;t know, because it makes you aware of how little you know, and so you will find the reason to keep learning. I certainly hope I have planted enough seeds of doubt in your mind, enough to question if your communication skills is <em>good enough</em>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Being an early employee at startup that exited]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/12/30/being-an-early-employee-at-startup-that-exited/"/>
    <updated>2016-12-30T20:22:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/12/30/being-an-early-employee-at-startup-that-exited</id>
    <content type="html"><![CDATA[<p>I am one of the early employees at Dropsuite, previously known as Dropmysite. Today, I was informed that <a href="https://www.google.com/finance?q=ASX%3ADSE&amp;ei=YOl6WPjdJ8XEuATl-YHwCA">Dropsuite</a> has IPOed in the Australian Stock Exchange. Technically, it is a <a href="https://en.wikipedia.org/wiki/Reverse_takeover">reverse IPO</a>. The whole process took one year. The Australian Stock Exchange, or Australian investors, is known to welcome technology companies, which is why local technology companies choose to list there. Another local example is <a href="http://mig.me/home">mig.me</a>.</p>

<p>It&#8217;s rare to have worked in a startup that exited. Rarer still, in Singapore. I&#8217;ve worked with 6 startups where only 2 of them exited. One(Dropsuite) IPOed, the other(Courex) got acquired. The rest closed down when the money ran out. If you are considering making a move to a startup, you can use my experience as a data point.</p>

<!-- more -->


<h2>Financially, is it worth the move?</h2>

<p>Most startups will offer below market salary and make it up using stock options. Stock options gives you the right to buy X number of stock of the company at X price at X time. Usually you only receive stock options after you&#8217;ve worked after a year or more. Every month, you continue to receive options, until the your allotment runs out. As an early employee, you share in the ownership of the company via owning the options. You partake in shaping the future of the company.</p>

<p>I was one of the early employees. I wasn&#8217;t senior management, but I was in Engineering as one of the lead engineers, leading one of the key products: Dropmyemail. There were about 10 people when I joined. At that time, we were still using a shared office, and the CEO was one table across me.</p>

<p>My options are only a few month&#8217;s worth of salary at the current price. Considering I earned a good chunk of the option pool, this shows that unless you are one of the founders or the investors, you won&#8217;t get rich through stock options.</p>

<h2>Is it worth it at all?</h2>

<p>It depends on which stage you are at your career. If you are young, and weighing between a startup or a corporation, go with the startup. You will learn how to make do with less resources, learn how other functions of the business worked, more importantly learn how to get things done. That experience is priceless and will prove an asset in your later years. If you are not young anymore, either start a company as a founder, or join as the senior management. Otherwise the opportunity cost does not justify the move.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Running an ecommerce logistics business is hard]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/12/24/running-an-ecommerce-logistics-business-is-hard/"/>
    <updated>2016-12-24T06:05:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/12/24/running-an-ecommerce-logistics-business-is-hard</id>
    <content type="html"><![CDATA[<p>I came into the logistics industry knowing nothing about it. Along the way I&#8217;ve witnessed competitors going bust(Zyllem), new entrants, competitors switching from logistics to technology(Anchanto), and more. It is a hyper competitive industry. I hope to offer an insider view of the industry, to show why it is so challenging, which hopefully will discourage new entrants, in turn making my job easier.</p>

<!-- more -->


<h2>Challenge 1: Consistency</h2>

<p>It is not how well you do yesterday, but how well you do every day that matters. Consistency is what separates the wheat from the chaff. All logistics companies can perform one delivery successfully on a single day. But to do it at scale, to do it consistently everyday, over a sustained period of time, is very difficult. Customers are paying precisely for that - reliability.</p>

<p>In technology, your product or service is delivered over a controlled environment. For machines, consistency is a natural state. You can change software at will, or expect results to always be the same, barring the same inputs. Not logistics. Where do you find a willing and able person to deliver a parcel? Finding one is trivial, how do you find people for one thousand, ten thousand, one hundred thousand parcels? How do you ensure that the person would deliver the parcel punctually? How do you know the person will perform the deliveries? What happens when the delivery person don&#8217;t turn up? Can you imagine your database server telling you one morning that he don&#8217;t feel like working that day? There are many human variables that can ruin a delivery. Many uncontrollable. As long as last mile deliveries are done by people, there will be that element of uncertainty.</p>

<p>Logistics needs people to perform repetitive tasks consistently over a sustained period. People are not machines. It is a constant battle to make people perform like machines. Eventually it wears you out mentally. That is why companies give up, and transit from a logistics company to a technology company, providing software for other logistics companies.</p>

<h2>Challenge 2: Coping with surges</h2>

<p>Singles day on November 11 is a online shopping day created out of nothing by Alibaba. On that day, we saw sales double or triple. Then there is Black Friday, double twelve, etc. Such is the might of marketing, that they can conjure record breaking sales on any day they choose. Digitally there is no problem coping - just order more servers. Machines don&#8217;t sleep, don&#8217;t complain of overtime and they don&#8217;t quit.</p>

<p>Assuming the sellers stocked up properly, how do you get the product into the hands of the buyer? How do you double your capacity just for that one day? Wait, this is a one day phenomenon and after that all the capacity we built up is going to be thrown away? Worse, do you believe sellers will pay more for delivery during surges? No. They will also insist that delivery standards remain as fast as usual. Because for consumers, it is common to cancel if they don&#8217;t receive their parcels within 2-3 days. When sales are lost due to cancellations, it is logical to shift the blame to the logistics company who cannot fulfill their orders in time. That is why Alibaba invested so heavily in logistics.</p>

<p>Let&#8217;s simplify the problem. Delivering at its current state(before self-driving cars that is), depends on finding three things: a willing person, a transport, or better - a willing person with his own transport.</p>

<h2>Challenge 3: Finance</h2>

<p>Let&#8217;s look at the problem of transport. Scaling transportation assets is simple - buy more vehicles. You buy enough to cope during the high season. Don&#8217;t forget, those vehicle assets are going to be idling during the low season. Depreciation will be glaring at you on your balance sheet. Alright, since it is short term, let&#8217;s rent. Unfortunately, short term rental are more expensive. Costs associated with fixed fleets can spiral out of control very easily. Do you have the money to be in the game? Don&#8217;t forget the margin for logistics is razor thin. Do you even make money after all these investments?</p>

<h2>Challenge 4: People</h2>

<p>Next, the problem of people. Where do you find the people to drive those vehicles? Let&#8217;s put up job ads. To cope with surges, we have to ramp up way before it comes. In practice, you build up your pool of inactive drivers, and call them up during surges. People can be found. The problem with people is not in finding them, but managing them. There are numerous people problems. People not showing up, which creates urgent reschedules. People stealing money collected. People stealing parcels. People being lazy, and not finishing their load. Worse, if they are driving company vehicles, there are even more problems. You have to foot for their petrol when they use the vehicle for personal use(of course they won&#8217;t admit). When there are accidents, you have to pay for fixing the damage. When there are traffic violations, you pay the fines. They won&#8217;t go away. As long as people are part of the equation, you have to deal with such problems. Are you sure you want to deal with such problems every day?</p>

<h2>Challenge 4: Competition</h2>

<p>Last mile delivery is something that anybody can perform. It is a commodity with little differentiation. There are perfect substitutes everywhere. There will always be the price pressure downwards. Margins are razor thin. It is a hyper competitive industry. Are you sure you want to enter this market, given much better alternatives available?</p>

<p>Of course I&#8217;m simplifying the picture. Even for a simple service like delivering, there are differentiators. Certain customers will want finer tracking as their parcels are high value items. If you have invested in technology, you win. Certain customers prefer API integration when creating orders and updating of tracking statuses. If you invested to build the technology, you win. Or if you can perform the delivery faster, at the same price, you win.</p>

<p>It is not impossible to build a thriving ecommerce logistics business, but it is difficult. From the outside, it looks antiquated, inefficient, and ripe for a rethink of the current obsolete ways. That is true 2-3 years ago. Now the landscape is different. New entrants with technology focus came, and has brought the state of logistics to a different level. It has advanced. The market should be consolidating in the next couple of years. I hope I have done my part in dispelling any thought of entering the logistics industry. There are numerous ways to make money, please don&#8217;t choose logistics.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Should you learn more programming languages?]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/11/13/should-you-learn-more-programming-languages/"/>
    <updated>2016-11-13T15:49:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/11/13/should-you-learn-more-programming-languages</id>
    <content type="html"><![CDATA[<p>In the book <a href="https://www.amazon.com/Pragmatic-Programmer-Journeyman-Master/dp/020161622X/ref=sr_1_1?ie=UTF8&amp;qid=1479025939&amp;sr=8-1&amp;keywords=pragmatic+programmer">Pragmatic Programmers</a>, the authors made a sensible recommendation: learn a new programming language every year. Each new programming language is a new perspective of solving problems. Adding more under your toolbox helps you gain different perspectives. It sharpens your technical judgment. But is it the best use of your time?</p>

<!-- more -->


<p>Our time is limited. We can only learn a limited amount of things. I feel that we should not be learning any new programming language every year. It is far better to learn a programming language from a different family every year. The more different they are, the better. One should aim to master an object-oriented language such as Java or C#, a dynamic scripting language such as Python, Javascript or Ruby, and a functional language, like Haskell, Scala or F#. You can&#8217;t go wrong with C or Golang either.</p>

<p>Once you have mastered the few common families, adding more and more languages marginally adds to your technical capabilities. Knowing one more way of reading a CSV file does not add much value to you.  On the contrary, I feel that one should master other areas in computer science once you have those languages in your toolbox. Areas like machine learning, computer vision and security. These multiplies your capabilities. Machine learning allows you to solve non-linear problems. Security gives a mindset of how to break things; helping you to build your product correctly from the start.</p>

<p>Definitely, learning is good. There are a lot of things I want to learn. Knowing that we only have limited time, means that we have to say no more often than not. My opinion is one should not invest time in learning more programming languages once you have mastered a few from different paradigm families. Instead, one should venture into other areas of computer science. Do share if you think otherwise.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deliberate Constraints]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/10/16/deliberate-constraints/"/>
    <updated>2016-10-16T15:36:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/10/16/deliberate-constraints</id>
    <content type="html"><![CDATA[<p>Two weeks ago, we removed the television in the house. The television, one of the staple appliance in every family where planners assumed that it was present in every house. It was the center of the living room. My children was spending too much time on the television for their parent&#8217;s liking. It has been 2 weeks. In the past during meal times, I see two zombies with eyes transfixed on the television; now they play with each other. Does having more <em>things</em>, means we lead a better quality of life?</p>

<!-- more -->


<p>My current <a href="https://www.courex.com.sg/">employer</a> is a bootstrapped company. It has never seen copious amounts of money. Therefore every decision was made with sustainability in mind. Rule number 1: Don&#8217;t lose money. Without money, the company was forced to do things differently.</p>

<p>To give the reader some context, one of the things we do is <a href="https://en.wikipedia.org/wiki/Last_mile_(transportation">last mile delivery</a>. We used to own a fleet of vehicles and hired full time drivers. Surely that must work because that was what everyone did - We thought. It didn&#8217;t. Owning a vehicle and having full time drivers on payroll was expensive. We didn&#8217;t have the money. We never had enough capacity to cater for the high season, and had vehicles idling during low season. We were forced to switch to the <a href="https://en.wikipedia.org/wiki/Crowdsourcing">crowd sourced</a> model. If we had the money, we would have bought more vehicles. We often wonder, was having no money the thing that saved us?</p>

<p><a href="https://en.wikipedia.org/wiki/Brunei">Brunei</a>, a small country, but blessed with plentiful oil resources. There is no income tax, free education and cushy jobs awaiting in the government. Hard work is optional. When oil prices began to tumble, <a href="http://www.economist.com/news/asia/21661040-autocratic-sultanate-turns-more-devout-oil-money-declines-all-pray-and-no-work">Brunei&#8217;s GDP contracted</a>. Her oil resources are estimated to last for another 24 years. More than half of her economy is linked to oil. When the oil tap dries, I wonder what would happen. Not far away from Brunei, lies another small <a href="https://en.wikipedia.org/wiki/Singapore">country</a>, cursed with no natural resources. When they went independent, even they themselves thought they couldn&#8217;t make it. Having no resources made them do things differently. I&#8217;m sure Brunei must have thought: was the oil a blessing or a curse?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Breaching the great firewall of china]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/09/20/breaching-the-great-firewall-of-china/"/>
    <updated>2016-09-20T06:15:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/09/20/breaching-the-great-firewall-of-china</id>
    <content type="html"><![CDATA[<p>It has been some time since I stepped into China. The great firewall has since advanced. This is a short guide to how to breach the <a href="https://en.wikipedia.org/wiki/Great_Firewall">great firewall</a> meant for the technically inclined. This guide is accurate as of 2016.</p>

<!-- more -->


<h2>Use OpenConnect</h2>

<p>In short, <a href="http://www.infradead.org/ocserv/index.html">OpenConnect</a> works. I&#8217;ve tried OpenVPN and ShadowSocks. Only OpenConnect works.</p>

<p>I used an open source project, <a href="https://github.com/jlund/streisand">Streisand</a> to set it up. Streisand needs a server to set up from. Any of the major cloud providers or any webhost providing Ubuntu 16.04 server will do. I used <a href="https://www.vultr.com/">Vultr</a>.</p>

<p>Streisand runs on <a href="https://www.ansible.com/">Ansible</a>, which I&#8217;m familiar with. First, you need to <code>git clone</code> the project to your local machine. I updated the IP address under the <strong>inventory</strong> file of the Streisand project to my Vultr server. Next, run the script. It took about 20 minutes for it to complete.</p>

<p>Once completed, a folder of HTML documents is generated on the local machine. The documents outlines the steps to connect to the remote server using the various protocols. The instructions were clear, and even included links to the binaries. Each document is unique to the server. The certs, passwords are all unique to the server. Most importantly, it worked. I was able to access Google, and the various blocked sites from China.</p>

<p>I hope this helps. For the non-technically inclined, unfortunately I wasn&#8217;t able to find a company that provides OpenConnect commercially. Perhaps this would get better in future. I&#8217;m sure there is a market for such a service.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Everday XPath - Operators]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-operators/"/>
    <updated>2016-09-11T06:28:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-operators</id>
    <content type="html"><![CDATA[<p>This blog post is part of a series on XPath. The content comes from my ebook <a href="http://www.everydayxpath.com">EverydayXPath</a>. Part of the content from the book will be released to the public as blog posts. In this post, we explain what XPath does. We disect the components of an XPath expression. And why the context is the key to forming the expression.</p>

<!-- more -->


<h2>Operators</h2>

<p>Operators are special characters that has special meaning in a XPath expression.</p>

<ul>
<li><strong>Child</strong> <code>/</code>: Selects the children of the current context. When used at the beginning of the expression, it starts from the root node.</li>
<li><strong>Recursive descent</strong> <code>//</code>: Searches the document, descending from the current context. When used at the beginning of the expression, it searches the entire document from the root node.</li>
<li><strong>Dot</strong> <code>.</code>: Selects the current context. By default it takes the root node as the current context.</li>
<li><strong>Double dot</strong> <code>..</code>: Selects the parent of the current context.</li>
<li><strong>Wildcard</strong> <code>*</code>: Selecta all nodes from the current context.</li>
<li><strong>Attribute</strong> <code>@</code>: Selects the node with the attribute and returns the attribute.</li>
<li><strong>Attribute wildcard</strong> <code>@*</code>: Selects nodes with any attributes and returns the attributes.</li>
<li><strong>Round brackets</strong> <code>()</code>: Expressions within round brackets takes precedence in the evaluation order.</li>
<li><strong>Square brackets</strong> <code>[]</code>: Used both as a subscript operator and to encapsulate a filter expression.</li>
<li><strong>Addition</strong> <code>+</code>: Performs addition.</li>
<li><strong>Subtraction</strong> <code>-</code>: Performs subtraction.</li>
<li><strong>Division</strong> <code>div</code>: Performs division.</li>
<li><strong>Multiplication</strong> <code>*</code>: Performs multiplication.</li>
<li><strong>Modulo</strong> <code>mod</code>: Performs modulo</li>
</ul>


<p>For the following examples, we would use the below as the reference document.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;active&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Child operator <code>/</code></h3>

<p>The child operator selects the children of the current context. When used at the beginning of the expression, it starts from the root node.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the <code>table</code> node starting from the root.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;active&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr/td
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all the <code>td</code> nodes who are children of <code>tr</code> nodes who are children of the <code>table</code> node. Notice that it does not select the <code>td</code> nodes in the inner <code>table</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;2&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;3&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;4&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span> <span class="nt">&lt;5&gt;</span>
</span><span class='line'>  <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/table&gt;</span>
</span><span class='line'><span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Recursive descent <code>//</code></h3>

<p>The recursive descent operator searches the document, descending from the current context. When used at the beginning of the expression, it searches the entire document from the root node.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//td
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all the <code>td</code> nodes. Notice that it selects all the <code>td</code> nodes regardless of their parents.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;2&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;3&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;4&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span> <span class="nt">&lt;5&gt;</span>
</span><span class='line'>  <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/table&gt;</span>
</span><span class='line'><span class="nt">&lt;/td&gt;</span>&#39;
</span><span class='line'><span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;6&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;7&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr/td//td
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all <code>td</code> nodes descending from the context of the <code>td</code> node of the root <code>table</code>. Notice that the first level <code>td</code> nodes are not selected.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;2&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Dot operator <code>.</code></h3>

<p>The dot operator selects the current context. By default it takes the root node as the current context.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//td[.=&quot;Bravo&quot;]
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the <code>td</code> node whose value is <code>Bravo</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Double dot operator <code>..</code></h3>

<p>The double dot operator selects the parent of the current context.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr/td/..
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the parent node of the <code>td</code> nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;2&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;3&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;4&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;tr&gt;</span> <span class="nt">&lt;5&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Wildcard operator <code>*</code></h3>

<p>The wildcard operator selects all nodes from the current context.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr/td/table/*/td
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all <code>td</code> nodes from the inner <code>table</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;2&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Attribute operator <code>@</code></h3>

<p>The attribute operator selects the node with the attribute and returns the attribute.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//table/@style
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the <code>table</code> with the <code>style</code> attribute and returns the <code>style</code> attribute.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>style=&quot;margin: 12px&quot;
</span></code></pre></td></tr></table></div></figure>


<h3>Attribute wildcard operator <code>@*</code></h3>

<p>The attribute wildcard operator selects nodes with any attributes and returns the attributes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//@*
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all the attributes found in any of the nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>class=&quot;active&quot; <span class="nt">&lt;1&gt;</span>
</span><span class='line'>style=&quot;margin: 12px&quot; <span class="nt">&lt;2&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Round brackets operator <code>()</code></h3>

<p>Expressions within round brackets takes precedence in the evaluation order.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>(//@*)[1]
</span></code></pre></td></tr></table></div></figure>


<p>The expression within the round brackets is evaluated first, and the first result is returned by the subscript operator.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>class=&quot;active&quot;
</span></code></pre></td></tr></table></div></figure>


<h3>Square brackets operator <code>[]</code></h3>

<p>Square brackets are either used as a subscript operator or to encapsulate a filter expression.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>(//td)[2]
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the second <code>td</code> node from the results of the expression encapsulated in the round brackets operator.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is another example as a subscript operator</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr[2]
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the second <code>tr</code> node which is a child of the <code>table</code> node.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The following example shows the square brackets operator encapsulating a filter expression.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>(//td)[last()]
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the last node from the results of the expression in the round brackets operator.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here is another example of encapsulating a filter expression.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//td[table]
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the <code>td</code> node which contains a <code>table</code> node.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/table&gt;</span>
</span><span class='line'><span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Arithmetic operators <code>+ - * div mod</code></h3>

<p>The arithmetic operators evaluates expressions to return numerical results.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>count(//td) + count(//table)
</span></code></pre></td></tr></table></div></figure>


<p>The <code>count</code> function returns the number of nodes returned from evaluating the expression. There are 7 <code>td</code> nodes and 2 <code>table</code> nodes which when added, returns 9.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>9.0
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Everday XPath - Node Test]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-node-test/"/>
    <updated>2016-09-11T06:11:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-node-test</id>
    <content type="html"><![CDATA[<p>This blog post is part of a series on XPath. The content comes from my ebook <a href="http://www.everydayxpath.com">EverydayXPath</a>. Part of the content from the book will be released to the public as blog posts. In this post, we learn about the only mandatory part of the XPath expression: Node Test.</p>

<!-- more -->


<h2>Node Test</h2>

<p>The node test is used as a filter to select the nodes we want. It is the only mandatory part in a XPath expression. We break a node test into 3 types.</p>

<ul>
<li><p><strong>Name test</strong>: It makes use of the inherent properties of a node to select it. Properties such as the type of the node.</p></li>
<li><p><strong>Node type test</strong>: Nodes can be generalized as a comment node, a text node, a processing instruction node or a catchall node type. The node type tests helps to filter along these lines.</p></li>
<li><p><strong>Targeted processing instruction test</strong>: This test selects processing instruction nodes with a defined type.</p></li>
</ul>


<p>For the following examples, we would use the below as the reference document.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;even&quot;</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;even&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Name Test</h2>

<p>The name test filter makes use of properties of the nodes.</p>

<h3>Asterisk <code>*</code></h3>

<p>The asterisk or the glob, selects everything.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>/table/tr/td/*
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all the nodes that come after the <code>td</code> nodes of the root level <code>table</code> node. It then selects the inner <code>table</code> as it came after the <code>td</code> nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>QName</h3>

<p>When we want to select something more specific, we use the <em>QName</em>. QName stands for qualified name and can be either a prefixed name or an unprefixed name.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>QName = PrefixedName | UnprefixedName
</span></code></pre></td></tr></table></div></figure>


<p>A prefixed name is made up of 2 parts: a prefix and a localpart separated by a colon. The prefix is a name space prefix and is optional.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>PrefixedName = Prefix &#39;:&#39; LocalPart
</span></code></pre></td></tr></table></div></figure>


<p>The unprefixed name and local part resolves to become a <em>NCName</em> which stands for non-colonized name: name without colons.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>UnprefixedName = LocalPart
</span><span class='line'>Prefix = NCName
</span><span class='line'>LocalPart = NCName
</span></code></pre></td></tr></table></div></figure>


<p><code>td</code> in the following expression below is a <em>NCName</em>. It means to select elements of the <code>td</code> type.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//td
</span></code></pre></td></tr></table></div></figure>


<p>The results returns a list of 7 <code>td</code> nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;2&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;3&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Delta<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;4&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span> <span class="nt">&lt;5&gt;</span>
</span><span class='line'>  <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/table&gt;</span>
</span><span class='line'><span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Echo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;6&gt;</span>
</span><span class='line'><span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;7&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Node Type Test</h2>

<p>There are times when you need a broader selection than a <em>NCName</em> and narrower than a <em>glob</em>. In such cases, there are 4 kinds of node types test which you can make use of.</p>

<ul>
<li><strong>comment()</strong>: Selects comment nodes.</li>
<li><strong>node()</strong>: Selects all nodes irregardless of type.</li>
<li><strong>text()</strong>: Selects the text from the current context.</li>
<li><strong>processing-instruction()</strong>: Selects the processing instruction nodes.</li>
</ul>


<p>For the following examples, we would use the below as the reference document.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Alpha<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;foo.jpg&quot;</span><span class="nt">&gt;&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;even&quot;</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>Charlie<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;even&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- &lt;td&gt;Delta&lt;/td&gt; --&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr</span> <span class="na">class=</span><span class="s">&quot;odd&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span>
</span><span class='line'>      <span class="nt">&lt;table</span> <span class="na">style=</span><span class="s">&quot;margin: 12px&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="c">&lt;!-- &lt;td&gt;Echo&lt;/td&gt; --&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>Foxtrot<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>comment()</h3>

<p>Selects comment nodes from the current context.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//tr[@class=&quot;even&quot;]/comment()
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the comment nodes from the context of the <code>tr</code> node with a class with value <em>even</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="c">&lt;!-- &lt;td&gt;Delta&lt;/td&gt; --&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>node()</h3>

<p>Selects all nodes irregardless of type, It even includes comment and processing instruction nodes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//tr[@class=&quot;even&quot;]/node()
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects all the nodes from the context of the <code>tr</code> node with a class with value <em>even</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span> <span class="nt">&lt;1&gt;</span>
</span><span class='line'><span class="c">&lt;!-- &lt;td&gt;Delta&lt;/td&gt; --&gt;</span> <span class="nt">&lt;2&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Compare this to the <em>glob</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//tr[@class=&quot;even&quot;]/*
</span></code></pre></td></tr></table></div></figure>


<p><em>node()</em> captures everything, even more than the <em>glob</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;td&gt;</span>Bravo<span class="nt">&lt;/td&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>text()</h3>

<p>Selects the text from the current context.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>//td/text()
</span></code></pre></td></tr></table></div></figure>


<p>This expression selects the inner text from the nodes selected. Notice that it returns an empty string if the context does not contain any text.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>&#39;Alpha&#39; <span class="nt">&lt;1&gt;</span>
</span><span class='line'>&#39;Bravo&#39; <span class="nt">&lt;2&gt;</span>
</span><span class='line'>&#39;Charlie&#39; <span class="nt">&lt;3&gt;</span>
</span><span class='line'>&#39;&#39; <span class="nt">&lt;4&gt;</span>
</span><span class='line'>&#39;Foxtrot&#39; <span class="nt">&lt;5&gt;</span>
</span><span class='line'>&#39;&#39; <span class="nt">&lt;7&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>processing-instruction()</h3>

<p>Selects the processing instruction nodes. Processing instruction nodes are usually found in XML documents. It usually carries meta information for applications. An example of a processing instruction node is below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;style.xsl&quot;?&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>It can be targeted. The example below selects only processing instructions with the target &#8220;xml-stylesheet&#8221;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>processing-instruction(&quot;xml-stylesheet&quot;)
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Everday XPath - The Expression]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-the-expression/"/>
    <updated>2016-09-11T05:53:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/09/11/everday-xpath-the-expression</id>
    <content type="html"><![CDATA[<p>This blog post is part of a series on XPath. The content comes from my ebook <a href="http://www.everydayxpath.com">EverydayXPath</a>. Part of the content from the book will be released to the public as blog posts. In this post, we explain what XPath does. We disect the components of an XPath expression. And why the context is the key to forming the expression.</p>

<!-- more -->


<h2>The Expression</h2>

<p>When we travel to a foreign country, we rely on directions to get to the place that we want. Similarly, an XPath expression is like us giving the computer directions to find a particular node in the document.</p>

<p>An XPath expression is made up of steps, evaluated from left to right. Each step moves closer to the target element. They are separated by the forward slash <code>/</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>step/step/step</span></code></pre></td></tr></table></div></figure>


<p>We define a step as a <em>location path</em>. A location path selects a set of nodes relative to the preceding step. When a location path starts with a forward slash, it starts from the root node.</p>

<p>A location path can be broken up into 3 distinct parts. An axis, a node test and a predicate. It follows the format below. Only the node test is required in an expression. The rest are optional.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>axis::node-test[predicate]</span></code></pre></td></tr></table></div></figure>


<p>The <strong>axis</strong> makes use of the relationship between the nodes selected to the context node to act as a filter. For example, the ancestor axis selects the ancestors of the current context. While the descendant axis selects the descendants of the current context. The axis is optional.</p>

<p>The <strong>node test</strong> can be thought of as a pattern used for matching the desired nodes. We make use of the properties of the node to form the pattern. For example, a valid node test would be <code>table</code> which means we want table nodes. The node test is required.</p>

<p>The <strong>predicate</strong> is a filter expression. It filters against the nodes selected in the axis and node test. It evaluates to return either a number or a Boolean value. If it is a number, it selects the node in that position. If it is a Boolean, it selects nodes that satisfies the predicate. The predicate is optional.</p>

<h2>Context</h2>

<p>Writing an XPath expression starts with knowing the context. Assuming there is a robot whose job is to fetch you things in the house. The robot understands XPath. I&#8217;m in my living room, sitting on the couch.</p>

<blockquote><p>From the living room, go to the second room, find the first shelve, bring me the first book.</p></blockquote>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./room[2]/shelve[1]/book[1]</span></code></pre></td></tr></table></div></figure>


<p>The living room was the context from which the expression started.</p>

<p>Assuming the root of the house starts from the door.</p>

<blockquote><p>From the door, find the first room, find the first shelve, find the first book</p></blockquote>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/door/room[1]/shelve/book[1]</span></code></pre></td></tr></table></div></figure>


<p>The context was from the root. That is like searching the document from the start.</p>

<p>Since I want a book, if I know the title, I can do this</p>

<blockquote><p>Find a book with the title &#8220;Infinite Jest&#8221;</p></blockquote>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//books[title="Infinite Jest"]</span></code></pre></td></tr></table></div></figure>


<p>The expression changes according to the context. The context sets the basis for the XPath expression. Think of how to choose your context - the expression will turn out differently.</p>

<p>Naturally, the next question is how should we choose the context? While they all work, there are differences in maintainability.</p>

<p>Consider these two factors:</p>

<ul>
<li>Does the page change often? Will your expression break when there are changes?</li>
<li>Do you understand what the expression means at first glance?</li>
</ul>


<p>Avoid using a context which has a high chance of changing. You don&#8217;t want your expression to break. When writing expressions, always prefer short to long, simple to complex, less syntax to more. Readability helps. Hopefully, these factors will clarify the approach you take when forming the XPath expression.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Writing an ebook]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/09/09/writing-an-ebook/"/>
    <updated>2016-09-09T06:13:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/09/09/writing-an-ebook</id>
    <content type="html"><![CDATA[<p>I spent the past 3 months writing an ebook: <a href="http://www.everydayxpath.com">EverydayXPath</a>. The idea came as I needed to write a <a href="http://www.seleniumhq.org/">Selenium</a> script. Naturally I needed to use <a href="https://en.wikipedia.org/wiki/XPath">XPath</a> for selecting nodes on the web page. As I was googling for solutions, documentation on XPath felt inadequate. I needed good examples and coherent explanations for the various operators. XPath and CSS are the two common query languages for querying XML/HTML documents. I felt there is a opportunity for a niche product. Let me share the setup I used for writing the ebook.</p>

<!-- more -->


<h2>Writing the content</h2>

<p>Writing an book is a lot of work. I spent an hour a day, about 3 months in all to complete it. The first part is research. Though I knew enough to write valid XPath expressions, I did not know it deep enough. I set out to read more about XPath. I read the <a href="https://www.w3.org/TR/xpath/">W3C specifications</a>. There was an <a href="http://shop.oreilly.com/product/9780596002916.do">O&#8217;Reilly book on XPath</a>  written more than 10 years ago. Apparently it didn&#8217;t sell well enough that O&#8217;Reilly <a href="http://commons.oreilly.com/wiki/index.php/XPath_and_XPointer">released the content</a> on its commons site. There are many online sites that documents XPath, though not well enough. I learned what I could.</p>

<p>I started by drafting the chapters I wanted. It is easier to start writing with a framework in mind. From then on, it is just a matter of showing up everyday and churning out the content. <a href="https://streaksapp.com/">Streaks</a> helped maintain my momentum. I wrote in plain text files on <a href="https://www.gnu.org/software/emacs/">Emacs</a>. I read about <a href="https://www.literatureandlatte.com/scrivener.php">Scrivener</a> but was never tempted as my fingers speaks Emacs. The text editor doesn&#8217;t matter as long as content gets written. At first the format of my text was <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a>. After I learned more about formatting, I switched to <a href="http://asciidoctor.org/docs/asciidoc-writers-guide/">Asciidoc</a>. Asciidoc suits ebooks better.</p>

<h2>Formatting</h2>

<p>The ebook had to be formatted in the major formats: <a href="https://en.wikipedia.org/wiki/Comparison_of_e-book_formats">HTML, PDF, MOBI and EPUB</a>. There are several tool chains available. I wanted a tool chain that can be used on the command line. I found <a href="https://www.gitbook.com/">Gitbook</a> and <a href="https://www.softcover.io/">Softcover</a>. I also saw <a href="https://atlas.oreilly.com/">O&#8217;Reilly Atlas</a>. Apparently it is invite only.</p>

<p>It was a toss up between Gitbook and Softcover. I tried Gitbook first as its eco-system looked more mature. The Gitbook workflow fit what I was looking for. I didn&#8217;t need to try Softcover. Gitbook depends on <a href="https://calibre-ebook.com/">Calibre</a> for formatting the ebooks. Calibre worked well enough.</p>

<h2>Workflow</h2>

<p>I had a <a href="https://www.gnu.org/software/make/">Makefile</a>. <code>make serve</code> would call Gitbook&#8217;s app server which renders Asciidoc or Markdown into HTML. I&#8217;m able to view the rendered content immediately. When I make changes, it automatically updates. The feedback loop is fast.</p>

<p>When I needed to build the books, I would call <code>make build</code> which calls the individual Gitbook build commands.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>serve:
</span><span class='line'>  ../node_modules/.bin/gitbook serve
</span><span class='line'>
</span><span class='line'>pdf:
</span><span class='line'>  ../node_modules/.bin/gitbook pdf ./ ./build/everydayxpath.pdf
</span><span class='line'>
</span><span class='line'>epub:
</span><span class='line'>  ../node_modules/.bin/gitbook epub ./ ./build/everydayxpath.epub
</span><span class='line'>
</span><span class='line'>mobi:
</span><span class='line'>  ../node_modules/.bin/gitbook mobi ./ ./build/everydayxpath.mobi
</span><span class='line'>
</span><span class='line'>build: pdf epub mobi
</span><span class='line'>  echo "built pdf, epub, mobi"
</span><span class='line'>
</span><span class='line'>.PHONY: serve</span></code></pre></td></tr></table></div></figure>


<p>That was all I needed.</p>

<h2>Website and payments</h2>

<p>The <a href="http://www.everydayxpath.com">EverydayXPath</a> website is a static HTML site hosted for free on <a href="https://pages.github.com/">Github Pages</a>. The website was written by me, the design was not. I bought a <a href="https://getbootstrap.com/">Bootstrap</a> theme from <a href="https://wrapbootstrap.com/">Wrapbootstrap</a>. The theme itself is a bunch of static HTML files. I was able to modify from it and get a professional looking website done in very short time, which is about 5-7 hours. I could have written one from scratch, but I would never be able to finish it in 5-7 hours.</p>

<p>When developing the website, I used <a href="https://www.npmjs.com/package/http-server">http-server</a>, a <a href="https://nodejs.org/en/">Node.js</a> package. It is a light web server which can render my website. I didn&#8217;t want to install <a href="https://www.nginx.com/">Nginx</a> or <a href="https://httpd.apache.org/">Apache</a> for rendering a one page website. That is overkill. http-server suited my needs perfectly.</p>

<p>For delivery of the digital product and payments, I chose <a href="https://gumroad.com/">Gumroad</a>. Gumroad doesn&#8217;t charge a monthly subscription, which suits me as I didn&#8217;t know how the ebook would sell. They charge a commission for every sale. If there is consistent volume, Gumroad offers a <a href="https://gumroad.com/features/pricing">subscription</a> model that has lower commission rates. The <strong>buy</strong> link on my website leads to Gumroad, where the payment takes place. Gumroad also handles the sending of the ebook to my customers.</p>

<h2>Marketing plan</h2>

<p>I know that writing the ebook is perhaps only 20% of the work. The real work is marketing. Hence, I&#8217;m putting up all the content from my ebook in a series of blog posts every week. My intention is to give would be readers a taste of the content. Hopefully I can convert them. The blog is an avenue for feedback. I also intend to measure all the marketing initiatives and publish the conclusions here. The world needs more data points on marketing technical ebooks. For a start, I&#8217;m going to concentrate on organic marketing techniques. Techniques that doesn&#8217;t require any money. I&#8217;m not ruling out paid marketing. So dear reader, if you&#8217;re interested in following this journey, do stay in touch by subscribing to this blog. Thanks!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A firing]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/06/05/a-firing/"/>
    <updated>2016-06-05T16:37:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/06/05/a-firing</id>
    <content type="html"><![CDATA[<p>I was hooked by the documentary series: <a href="https://en.wikipedia.org/wiki/Chef%27s_Table">Chef&#8217;s table</a>. Each episode is about a famous chef. What hooked me was how human each of them was. They are not famous by default. Everyone of them had their struggles. Each of their journey to the zenith was hard. Perhaps it is cultural. We are taught to portray ourselves as successful, taught to hide our own imperfections. If <strong>Chef&#8217;s table</strong> is angled to show how good the chef was, how talented they are, I wonder, would the viewer relate personally to the chef? It is because they are imperfect and everyone is, that they connect.</p>

<p>Likewise, I am hardly perfect. I&#8217;d like to share a story of one of my failures. I&#8217;m seeing some of the people around me making the same mistakes. In my naive thinking, my stories might prevent the reader from falling in the same pothole. We should learn to celebrate failures. What failure is worse than being fired?</p>

<!-- more -->


<h2>Being fired</h2>

<p>It is taboo to say that you were fired. Being fired hints of incompetence. It was my second stint in web development. That was many years ago when I just started working. I was brought in as a consultant. The company did not have offices and everybody worked remotely. I was tasked to build a CRUD app with a good friend who did the user interface. We had weekly meet ups with the boss at Starbucks, where we showed the boss our progress and obtained feedback.</p>

<p>It was smooth in the beginning. At that time I had my own side projects. I was working on my side projects and doing consulting at the same time. I didn&#8217;t spend as much time as I should on consulting work as I felt I can make it up later. As a result, the consulting work did not move as fast as expected. I thought, as long as it gets done in the end, it should be OK.</p>

<p>The boss met me alone one day. His feedback was I wasn&#8217;t taking the deadlines seriously enough. During meetings, sometimes I would give frivolous answers to serious questions. And my deadlines kept slipping. I need to take the work more seriously. In a small company like his, he cannot afford to keep people who cannot perform consistently. I listened.</p>

<p>I was asked to develop a feature that allows the user to send Facebook messages to their Facebook contact list. Then, I was new to Facebook API. What we were trying to do is not common. There were a few things I weren&#8217;t sure. There was another developer within the company who built a Facebook app. I started asking the developer questions on the intricacies of Facebook API.</p>

<p>A couple of weeks later, the boss asked to meet me alone again. I knew it was bad news. The reason is I was brought in as the expert, not that developer. I should be the one digging deep. He felt that I wasn&#8217;t performing as well as he expected. And taking up his other resources at the same time. I had to go.</p>

<h2>Conclusion</h2>

<p>It struck deeply. The lesson I took away is I have to be professional in my work. When it is time to work, be serious and make the effort. Be professional in every interation you have with others. People are constantly evaluating you. In small companies, there is no room for poor performers as resources are tight. The bar for performance gets higher as you get older. I&#8217;ve had the misfortune of letting go of people whom made the same mistakes as I did. Don&#8217;t let that happen to you.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How does FreedomVPN work]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/05/29/how-does-freedomvpn-work/"/>
    <updated>2016-05-29T05:54:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/05/29/how-does-freedomvpn-work</id>
    <content type="html"><![CDATA[<p>I just watched the Champion&#8217;s League Final streamed live on my laptop. I watched it on <a href="http://www.pptv.com/">PPTV</a> in Singapore. This is made possible by FreedomVPN(Which amazingly, does not have a landing page of its own where I can link to). Recently, I switched my ISP(Internet Service Provider) to <a href="http://www.viewqwest.com/">Viewqwest</a>. This far, so good. Their product FreedomVPN, has opened the door to enjoying Internet TV from most of the popular content sites of the world. To many, it is like voodoo. Let me try to explain in broad strokes how they did it. Disclaimer: these are my conjectures and has not been validated with Viewqwest.</p>

<!-- more -->


<h2>Just watch it</h2>

<p>We didn&#8217;t realise we had Freedom VPN at the start. How we discover it was amusing. I realised that we suddenly had more titles to choose from Netflix. We thought the Singapore catalogue has been beefed up. Only after discovering those new titles can only be seen when we are at home, we then realised it was Freedom VPN.</p>

<p>There is no need to configure anything. Just watch it. It works across your smart phones, media players and the web browser. It is indeed convenient. It quickly won us over. We now access titles available from the US catalogue of Netflix. We can view BBC, the Chinese media sites and so many more.</p>

<p>With the new content that is now available to my family, we ended our cable TV subscription. It is obvious that media content delivered over the Internet is going to be the norm. My children will never experience catering their own schedules around the TV&#8217;s programme schedule, or the frustration of being restricted to watching it on the TV.</p>

<h2>When you press &#8220;Sherlock&#8221;</h2>

<p>I had described what the user experience is like. Let me lay out the requirements.</p>

<ul>
<li>No configuration needed</li>
<li>Connects to multiple content providers, each serving different countries</li>
<li>Works on all devices</li>
</ul>


<p><a href="http://www.imdb.com/title/tt1475582/">Sherlock</a> is a brilliant TV show that is not available in the Singapore Netflix catalogue but is, on the US one. When I select <strong>Sherlock</strong>, what really happens?</p>

<p>My web browser asks Netflix for <strong>Sherlock</strong>. The request has a problem. Where is Netflix? The expression <strong>www.netflix.com</strong> does not say where it is. It needs an address, an IP address. To translate <strong>www.netflix.com</strong> to an IP address, it asks a <a href="https://en.wikipedia.org/wiki/Domain_Name_System">DNS</a> server. When you&#8217;re on FreedomVPN, you are asking Viewqwest&#8217;s DNS server.</p>

<p>On my laptop which is served by Viewqwest,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ nslookup www.netflix.com
</span><span class='line'>
</span><span class='line'>Non-authoritative answer:
</span><span class='line'>Name:   www.netflix.com
</span><span class='line'>Address: some.ip.address
</span><span class='line'>Name:   www.netflix.com
</span><span class='line'>Address: some.ip.address
</span><span class='line'>Name:   www.netflix.com
</span><span class='line'>Address: some.ip.address</span></code></pre></td></tr></table></div></figure>


<p>I can&#8217;t divulge what the IP addresses are, but I can tell you where they point at: somewhere from Viewqwest&#8217;s office, in Singapore.</p>

<p><img class="right" src="https://s3.amazonaws.com/static.liangzan.net/blog/singapore_netflix_lookup.png" title="Where Netflix is from FreedomVPN" ></p>

<p>On a non-Viewqwest network,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Non-authoritative answer:
</span><span class='line'>www.netflix.com canonical name = www.geo.netflix.com.
</span><span class='line'>www.geo.netflix.com     canonical name = www.us-west-2.prodaa.netflix.com.
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.34.178
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.37.191
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.40.137
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.4.148
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.15.237
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.22.153
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.23.124
</span><span class='line'>Name:   www.us-west-2.prodaa.netflix.com
</span><span class='line'>Address: 54.214.28.210</span></code></pre></td></tr></table></div></figure>


<p>It is pointing unmistakably to Netflix servers. What does this mean?</p>

<blockquote><p>Masquerading: figurative sense of &#8220;false outward show&#8221; is from 1670s.</p></blockquote>


<p>Requests are inherently gullible. They are led to believe that Netflix is really at Viewwqwest&#8217;s offices. Off they went. Does anyone really believe that the files of <strong>Sherlock</strong> are kept at Viewqwest&#8217;s office? It isn&#8217;t. Now, our request needs to be satisfied with <strong>Sherlock</strong>. Where do we get <strong>Sherlock</strong>? From Netflix obviously.</p>

<p>Why would Netflix give it to the request? Remember, the request came from Singapore. <strong>Sherlock</strong> is <em>not</em> available for Singapore viewers. That is why we got to tell Netflix that the request did not come from Singapore, but from the US.</p>

<p><img class="right" src="https://s3.amazonaws.com/static.liangzan.net/blog/netflix-access-activity.png" title="Netflix activity" ></p>

<p>Look at my screenshot. This came from my activity logs in Netflix. I watched Netflix from US without me physically in the US. Where do the IP addresses point to?</p>

<p><img class="right" src="https://s3.amazonaws.com/static.liangzan.net/blog/viewqwest-us-ip.png" title="Viewqwest US IPs" ></p>

<p>Coming back to our request, what happens is our original request is routed to Viewqwest offices in the US. It then <em>pretends</em> that the source is from the US, sends to Netflix, gets <strong>Sherlock</strong>, routes back to the Singapore office, and then finally back to the end user, me, happily watching Sherlock duel with Moriarty. FreedomVPN listens actively for requests to their list of supported content websites. It then performs this form of masquerading to geo-unblock content for you. This is FreedomVPN.</p>

<h2>Cat and Mouse</h2>

<p>With Netflix clamping down on proxies, Viewqwest through Freedom VPN is the only vendor that I know of, that is able to circumvent content geo-blocking. They are treading a thin line.</p>

<p>Does it infringe terms of use? I don&#8217;t know. Content providers won&#8217;t be happy knowing that their content can be accessed in areas where it is not supposed to. Knowing is one thing, <strong>enforcing</strong> is another. Is it worth Netflix&#8217;s time to spend time and resources to go after FreedomVPN? Maybe not, since Viewqwest subscribers are not many enough to warrant spending the energy. I&#8217;m sure they have better things to do. As long as FreedomVPN continues to be a niche player, it should continue to stay under the radar. Perhaps that is why it never got its own landing page.</p>

<p>I see some Viewqwest customers complain that FreedomVPN is not stable. It will never be. Accept that this is a cat and mouse game. This solution is a workaround, and will never work cleanly unless geo-blocking is abolished. But for the convenience of watching <strong>Sherlock</strong> with one click, I&#8217;m wiling to accept that good enough is <em>good enough</em>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to set up a remote VPN using Sophos UTM]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/04/10/how-to-set-up-a-remote-vpn-using-sophos-utm/"/>
    <updated>2016-04-10T06:49:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/04/10/how-to-set-up-a-remote-vpn-using-sophos-utm</id>
    <content type="html"><![CDATA[<p>My office has a Sophos UTM. It acts as a firewall for the office network. We also use it as a VPN server. It allows us to access the machines in the office network. More importantly, it allows remote users to access the servers. Our servers have access restricted to a white listed list of IP addresses. This way, we only open up the white list to the office network. This allows our people to work from anywhere. We don&#8217;t have to keep updating the white list of IP addresses. When I tried setting it up, I could not find articles documenting how to do it. Hopefully it will point you in the right direction.</p>

<!-- more -->


<h2>Setting up the Remote VPN</h2>

<p>To set it up, I referred to the manual from Sophos. Their <a href="https://www.sophos.com/en-us/support/knowledgebase/119209.aspx">knowledge base</a> contains the administrative guide. Download the administrative guide for your version of UTM.</p>

<p>The relevant chapter is <strong>Remote Access > SSL</strong>. There also plenty of articles and videos on the web on how to set that up. I won&#8217;t repeat them so as not to bore the reader.</p>

<h2>Masquerading traffic from the office</h2>

<p>My aim is when I log into the VPN from a remote location, my traffic should masquerade as coming from the office. To the outside world, my requests comes from the office network&#8217;s IP address. To do that, I need to add a Masquerade rule. Go to <strong>Network Protection > NAT</strong>, create a new Masquerading rule by clicking on the button <strong>Create Masquerading Rule</strong>.</p>

<p><img src="https://s3.amazonaws.com/static.liangzan.net/blog/sophos-utm-create-new-masquerading-rule.png" title="Sophos UTM Create New Masquerading Rule" ></p>

<p>Select the network definition which represents the remote SSL users(you would have defined them when setting up the remove VPN). Select <strong>WAN</strong> as your interface, as you would like the traffic to go out. Click <strong>Save</strong>. Enable the rule by turning on the rule in the toggle button. Your rule should look like the screenshot below. You&#8217;re done. Hope this helps.</p>

<p><img src="https://s3.amazonaws.com/static.liangzan.net/blog/sophos-utm-masquerading-rule.png" title="Sophos UTM Masquerading Rule" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lessons learned when working with a remote team]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/04/01/lessons-learned-when-working-with-a-remote-team/"/>
    <updated>2016-04-01T06:42:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/04/01/lessons-learned-when-working-with-a-remote-team</id>
    <content type="html"><![CDATA[<p>I have both worked and managed remotely. I would like to share what works when managing a remote engineering team. Remote working is different from outsourcing. I would consider a remote team part of the company.</p>

<!-- more -->


<h2>Remote vs Local</h2>

<p>As a former remote worker, I like working remotely. I understand the draw of working remotely. Less distractions. Flexible time. Work life balance. Access to larger pool of candidates. There are also advantages to working together in an office. There is no better form of communication than speaking in person.</p>

<p>Both forms of working have their strengths and weaknesses. Use whichever that fits your situation.</p>

<h2>Hire experienced workers</h2>

<p>In a perfect world, everybody would like to hire experienced workers. For remote work, I&#8217;d see it as critical. The candidate should have the skills to perform the work needed. Not learn on the job. Why so? Learning is handicapped when a person is remote. He or she will not be able to learn as effectively because communication is degraded. Relying on instant messaging, emails or phone calls is not as effective. It takes up more of both the mentor&#8217;s time and the worker&#8217;s time.</p>

<h2>Define clear tasks</h2>

<p>In a perfect world you would like to know in advance the work needed to be done. That doesn&#8217;t happen in the real world. For remote workers, I&#8217;d entrust tasks which have been done before. Not open-ended projects. Why so? Because you need to be fair to the remote worker. Deny it or not, there is a mistrust of workers you don&#8217;t see at the desk. Is he working or watching Youtube at home? It helps immensely when you assign a task that you know how to do it. You would know how long it should take. If it takes too long, you know it is time to come in. If it is faster, congratulations, you have someone contributing effectively. Another factor is how independent the work is. The more independent, the better. It cuts down the need for communication. Communication is always the bottleneck for remote work.</p>

<h2>Communication is a necessity</h2>

<p>Communication should happen regularly at defined times. It is up to the team&#8217;s preference. I feel that there should happen at least once every 2 days or so. I find that most developers I know, don&#8217;t have the inclination to update their progress regularly without prompting. It should be the manager&#8217;s responsibility to ask for it.</p>

<p>Remote working goes against many culture norms especially in Asia. If the management is not open to new ideas, it may be an uphill cause. Company culture matters when deciding if you want to do it. In conclusion, if the work is well defined and the worker have experience doing it, no harm going remote. If not, better not.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Prefer lifting to destructuring in Scala]]></title>
    <link href="http://liangzan.github.com/blog/blog/2016/03/13/prefer-lifting-to-destructuring-in-scala/"/>
    <updated>2016-03-13T15:56:00+00:00</updated>
    <id>http://liangzan.github.com/blog/blog/2016/03/13/prefer-lifting-to-destructuring-in-scala</id>
    <content type="html"><![CDATA[<p>This is one of the few things which I discovered along the way as I was learning Scala. Always prefer lifting a function than destructuring.</p>

<!-- more -->


<p>For example, I have a function which returns the capital given the two letter country code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">def</span> <span class="n">countryCapital</span><span class="o">(</span><span class="n">countryCode</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">???</span>
</span></code></pre></td></tr></table></div></figure>


<p>This function returns an <code>Option[String]</code> type. If the capital exists, it returns the capital as a <code>String</code> contained in the <code>Option</code> monad. If not, it returns a <code>None</code>.</p>

<p>I want to upper case the results returned. This was what I was doing in my early days.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">capital</span> <span class="k">=</span> <span class="n">countryCapital</span><span class="o">(</span><span class="n">countryCode</span><span class="o">)</span>
</span><span class='line'><span class="k">val</span> <span class="n">upcasedCapital</span> <span class="k">=</span> <span class="n">capital</span> <span class="k">match</span> <span class="o">{</span>
</span><span class='line'>   <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">toUpperCase</span>
</span><span class='line'>   <span class="k">case</span> <span class="nc">None</span> <span class="k">=&gt;</span> <span class="nc">None</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then I realised lifting the <code>Option</code> type is a more idiomatic way.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">capital</span> <span class="k">=</span> <span class="n">countryCapital</span><span class="o">(</span><span class="n">countryCode</span><span class="o">)</span>
</span><span class='line'><span class="k">val</span> <span class="n">upcasedCapital</span> <span class="k">=</span> <span class="n">capital</span><span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="n">c</span> <span class="k">=&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">toUpperCase</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It is not necessary to destructure the type only to put it back again. Look how short it is, and clear its intention is. It did exactly the same things the earlier code snippet did.</p>

<p>When you see a lot of destructuring using pattern matching in a Scala code, it is almost always a code smell. Always prefer lifting over destructuring.</p>
]]></content>
  </entry>
  
</feed>
